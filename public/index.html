<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="https://fengyuanchen.github.io/cropperjs/css/cropper.css">
    <link rel="stylesheet" href="https://unpkg.com/image-compare-viewer/dist/image-compare-viewer.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="root"></div>
<script src="../dist/main.bundle.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
<script src="options.js" type="text/javascript"></script>
<script>


    setTimeout(async () => {
        photobox = await new PhotoBox({
            backend: 'http://localhost:5000',
            container: 'root',
            options: options,
            lang: 'ua',
            itemsPerPage: 1,
            theme: 'cosmo',
            defaultBorderWidth: 2,
            preselectedOptions: [

            ]
        }, (e) => {

            //e.clear()
        });

        setTimeout(() => {
            photobox.setPreselectedOptions(
                [
                    {
                        "option_id": 96,
                        "option_value_id": "397",
                        "name": "Тип печати",
                        "value": "Лаборатория",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 9,
                        "option_value_id": "402",
                        "name": "Формат бумаги",
                        "value": "9x13",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 11,
                        "option_value_id": "32",
                        "name": "Тип бумаги",
                        "value": "Матовая",
                        "weight": 0.1,
                        "checked": true
                    },
                    {
                        "option_id": 79,
                        "option_value_id": "330",
                        "name": "Кадрирование",
                        "value": "Кадр целиком",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 10,
                        "option_value_id": "26",
                        "name": "Плотность в гм",
                        "value": "200гм",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 82,
                        "option_value_id": "343",
                        "name": "Рамка",
                        "value": "Без рамки",
                        "weight": 0,
                        "checked": true
                    }
                ]
            )
        }, 500000);
        console.log(photobox);

        let images = [
            'grid.jpg',
            'tvtest.jpg',
            '2020-lamborghini-essenza-scv12-8k-cc-5120x2880.jpg',
            '2020-lili-reinhart-lofficiel-usa-photoshoot-4k-oa.jpg      ',
            '2020-madelaine-petsch-5k-wv-5120x2880.jpg                  ',
            '2020_bmw_m8_competition_coupe_4k_hd-3840x2160.jpg          ',
            '4k-peyton-list-2019-gq-3840x2160.jpg                       ',
            'alexandra-daddario-in-2020-4k-m2.jpg                       ',
            'alexis-ren-2020-df.jpg                                     ',
            'alexis-ren-49.jpg                                          ',
            'alexis-ren-4k-3k.jpg                                       ',
            'alexis-ren-photoshoot-xp.jpg                               ',
            'algonquin-provincial-park-on-canada-ay-5120x2880.jpg       ',
            'kw0SiO5vR-s.jpg                                            ',
            'MH9LTLNbOBo.jpg                                            ',
            'Umo40svoqCY.jpg                                            ',
            'WAnirTz5c0M.jpg                                            ',
            'Xs5Ayxz4OLQ.jpg',
        ]

        const host = "http://localhost:3000/img/"
        images = images.map(i => {
            return {
                "src": {
                    "full": `${host}${i.trim()}`,
                    "thumbnail": `${host}${i.trim().replace(".jpg", "-small.jpg")}`
                },
                "quantity": 2
            }
        })
        console.log(images);

        photobox.onReady(() => {
            console.log('init');
            photobox.clear();
            photobox.addImages([


                    {
                        "colorAdjustment": {
                            "saturation": 1,
                            "brightness": 1,
                            "contrast": 1
                        },

                        "detectAndFillWithGradient": false,
                        "frame": {
                            "color": "#ffffff",
                            "type": "none",
                            "thickness": 5
                        },
                        "imagePrintMode": "CROP",
                        "quantity": 1,
                        "rotate": 0,
                        "isManuallyRotated": false,

                        "src": {
                            "thumbnail": "https://foto124.ru/image/cache/customer/authorized/dc20d1211f3e7a99d775b26052e0163e/A68A4331_ddec606e90325b5a28b0b0a92d25cffd-200x300-width.jpg",
                            "full": "https://foto124.ru/image/order/6139-d3073e574a74/05_12_2022-6139-makarova-ekaterina-andreevna/10h15/matovaja/bez-polej///1_A68A4331_ddec606e90325b5a28b0b0a92d25cffd.jpg"
                        },
                        "autoColorEnhance": false,
                        "autoDetectBestFrame": false,
                        "resolution": "3600x5400",
                        "url": "https://foto124.ru/image/order/6139-d3073e574a74/05_12_2022-6139-makarova-ekaterina-andreevna/10h15/matovaja/bez-polej///1_A68A4331_ddec606e90325b5a28b0b0a92d25cffd.jpg",
                        "dest": {
                            "1": "image/order/render/6139-13e83ffdf732/05_12_2022-6139-makarova-ekaterina-andreevna/10h15/matovaja/bez-polej//"
                        },
                        "targetPath": "image/order/render/6139-13e83ffdf732/05_12_2022-6139-makarova-ekaterina-andreevna/10h15/matovaja/bez-polej//"
                    },
                {
                    "quantity": 1,
                    "resolution": "1216x912",

                    "src": {
                        "full": "http://localhost:3000/img/glossy_10x15e15d4e88f87b947e3e9b04210b7d03d5.jpg",
                        "thumbnail": "http://localhost:3000/img/glossy_10x15e15d4e88f87b947e3e9b04210b7d03d5.jpg"
                    },
                    "targetPath": "image/order/render/7213-0bae1909bef8/7213-79136206185/glossy/10x15//1/",
                    "url": "glossy_10x15b10c48096d3276649d1e9674762a8cf1.jpg",
                    "zoom": 0
                },
                {
                    "colorAdjustment": {
                        "saturation": 1,
                        "brightness": 1,
                        "contrast": 1
                    },
                    "cropData": {
                        "x": 0,
                        "y": 0,
                        "width": 496.23529411764713,
                        "height": 333,
                        "rotate": 0
                    },
                    "cropDataForRender": {
                        "x": 0,
                        "y": 0,
                        "width": 99.247,
                        "height": 100,
                        "rotate": 0,
                        "scaleX": 0,
                        "scaleY": 0
                    },
                    "canvasData": {
                        "left": 0,
                        "top": 33.39999999999999,
                        "width": 200,
                        "height": 133.20000000000002,
                        "naturalWidth": 500,
                        "naturalHeight": 333
                    },
                    "detectAndFillWithGradient": false,
                    "frame": {
                        "color": "#ffffff",
                        "type": "none",
                        "thickness": 5
                    },
                    "imagePrintMode": "CROP",
                    "quantity": 1,
                    "rotate": 90,
                    "isManuallyRotated": false,
                    "size": {
                        "height": 152,
                        "width": 102
                    },
                    "src": {
                        "thumbnail": "https://pechat55.ru/image/cache/customer/guest/4fa15bd2eeef2c889b142aa09051a5a8/ea01678e0c08f2f3e3893e38dd34e682-500x333-width.jpg",
                        "full": "https://xn--80aj0aafqej6a4c.xn--80asehdb/image/order/7213-da592a3873e2/7213-79136206185/glossy/10x15//1//glossy_10x15ea01678e0c08f2f3e3893e38dd34e682.jpg"
                    },
                    "zoom": 0.36363636363636365,
                    "autoColorEnhance": false,
                    "autoDetectBestFrame": false,
                    "resolution": "5760x3840",
                    "url": "https://xn--80aj0aafqej6a4c.xn--80asehdb/image/order/7213-da592a3873e2/7213-79136206185/glossy/10x15//1//glossy_10x15ea01678e0c08f2f3e3893e38dd34e682.jpg",
                    "dest": {
                        "1": "image/order/render/7213-0bae1909bef8/7213-79136206185/glossy/10x15//1/"
                    },
                    "targetPath": "image/order/render/7213-0bae1909bef8/7213-79136206185/glossy/10x15//1/"
                }

            ]);

        });


        setTimeout(() => {
            for(let i = 1; i <= 0; i++){
                for(let j = 0; j <= 500; j++){
                   setTimeout(() => {
                       photobox.addImages([
                           {
                               "src": {
                                   "thumbnail": `./img/${i}-thumbnail.jpg`,
                                  // "adjusted": `./img/1654596030680.jpg`
                               },
                               "resolution": "5120x2880",
                               "frame": {
                                   "color": "#ffffff",
                                   "type": "none",
                                   "thickness": 5
                               },
                               "size": {
                                   "width": 9,
                                   "height": 9
                               },

                               "quantity": 1,
                               "zoom": 0
                           }
                       ])
                   }, 10)
                }
            }
        }, 5);

        photobox.onInit = function () {
            console.log('onInitGlob');

        }

        photobox.onDeleteAllPhotos(function () {
            console.log('onDeleteAllPhotos');
            localStorage.removeItem("images");
        });

        let progress = 1;
        setTimeout(() => {
            photobox.setImageUploadProgress(100);
           // photobox.setImageProcessingStatus('imageUnpacking');
        }, 500)

        setTimeout(() => {
            photobox.setImageProcessingStatus('');
        }, 5000)

        photobox.onMakeOrder((data) => {
            //photobox.clear()
            console.log(data.photos.slice(0,1));
            //  console.log(data.photos[0].cropData);
        });
        photobox.onOpenUploadWindow(() => {
            alert("open window");
        })
        photobox.onPropertiesChanged((data) => {
            console.log('onPropertiesChanged');
            console.log(data);
        });
    }, 1000);
</script>

</body>
</html>
