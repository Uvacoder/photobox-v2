<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="https://fengyuanchen.github.io/cropperjs/css/cropper.css">
    <link rel="stylesheet" href="https://unpkg.com/image-compare-viewer/dist/image-compare-viewer.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div style="height: 0px; background: #0d5470; width: 100%"></div>
<div id="root"></div>
<script src="../dist/main.bundle.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2" crossorigin="anonymous"></script>
<script src="options.js" type="text/javascript"></script>
<script>


    setTimeout(async () => {
        photobox = await new PhotoBox({
            backend: 'http://localhost:5000',
            container: 'root',
            options: options,
            lang: 'ua',
            itemsPerPage: 16,
            theme: 'cosmo',
            defaultBorderWidth: 2,
            preselectedOptions: [

            ]
        }, (e) => {

            //e.clear()
        });

        setTimeout(() => {
            photobox.setPreselectedOptions(
                [
                    {
                        "option_id": 96,
                        "option_value_id": "397",
                        "name": "Тип печати",
                        "value": "Лаборатория",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 9,
                        "option_value_id": "402",
                        "name": "Формат бумаги",
                        "value": "9x13",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 11,
                        "option_value_id": "32",
                        "name": "Тип бумаги",
                        "value": "Матовая",
                        "weight": 0.1,
                        "checked": true
                    },
                    {
                        "option_id": 79,
                        "option_value_id": "329",
                        "name": "Кадрирование",
                        "value": "Кадр целиком",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 10,
                        "option_value_id": "26",
                        "name": "Плотность в гм",
                        "value": "200гм",
                        "weight": 0,
                        "checked": true
                    },
                    {
                        "option_id": 82,
                        "option_value_id": "343",
                        "name": "Рамка",
                        "value": "Без рамки",
                        "weight": 0,
                        "checked": true
                    }
                ]
            )
        }, 500);
        console.log(photobox);

        let images = [
            'tvtest.jpg',
            '2020-lamborghini-essenza-scv12-8k-cc-5120x2880.jpg',
            '2020-lili-reinhart-lofficiel-usa-photoshoot-4k-oa.jpg      ',
            '2020-madelaine-petsch-5k-wv-5120x2880.jpg                  ',
            '2020_bmw_m8_competition_coupe_4k_hd-3840x2160.jpg          ',
            '4k-peyton-list-2019-gq-3840x2160.jpg                       ',
            'alexandra-daddario-in-2020-4k-m2.jpg                       ',
            'alexis-ren-2020-df.jpg                                     ',
            'alexis-ren-49.jpg                                          ',
            'alexis-ren-4k-3k.jpg                                       ',
            'alexis-ren-photoshoot-xp.jpg                               ',
            'algonquin-provincial-park-on-canada-ay-5120x2880.jpg       ',
            'kw0SiO5vR-s.jpg                                            ',
            'MH9LTLNbOBo.jpg                                            ',
            'Umo40svoqCY.jpg                                            ',
            'WAnirTz5c0M.jpg                                            ',
            'Xs5Ayxz4OLQ.jpg',
        ]

        const host = "http://localhost:3000/img/"
        images = images.map(i => {
            return {
                "src": {
                    "full": `${host}${i.trim()}`,
                    "thumbnail": `${host}${i.trim().replace(".jpg", "-small.jpg")}`
                },
                params: {
                    "album_photo_id": "59197",
                    "album_id": "2745",
                    "is_polaroid": "0",
                    "customer_id": "0",
                    "session_id": "0705d9d7867775d1d9533e99c09932ab",
                    "image": "customer/guest/1d2e6d3c9a0f4ef664249e8b379d22a3/24bb0010b1599407560317a28701075d.jpg",
                    "hash": "c31512224b512965a3fa426a179855fc",
                    "sort_order": "0",
                    "thumbnail": "https://pechat.photo/image/cache/customer/guest/1d2e6d3c9a0f4ef664249e8b379d22a3/24bb0010b1599407560317a28701075d-280x157-width.jpg",
                    "resolution": "3840x2160"
                }
            }
        })
        console.log(images);

        photobox.onReady(() => {
            console.log('init');
            photobox.clear();
            photobox.addImages([{
                "colorAdjustment": {
                    "saturation": 1,
                    "brightness": 1,
                    "contrast": 1
                },
                "cropData": {
                    "x": 102.02004425348963,
                    "y": 53.94913613621321,
                    "width": 14.683454255442014,
                    "height": 21.88122594928614,
                    "rotate": 0
                },
                "cropDataForRender": {
                    "x": 36,
                    "y": 31,
                    "width": 5,
                    "height": 13,
                    "rotate": 0
                },
                "canvasData": {
                    "left": -868.494926999881,
                    "top": -450.5426016105419,
                    "width": 2383.6353075454454,
                    "height": 1489.7720672159035,
                    "naturalWidth": 280,
                    "naturalHeight": 175
                },
                "detectAndFillWithGradient": false,
                "frame": {
                    "color": "#ffffff",
                    "type": "zebra",
                    "thickness": 5
                },
                "imagePrintMode": "CROP",
                "options": [
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    "20",
                    "26",
                    "31",
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    "330",
                    null,
                    null,
                    "422",
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    "397"
                ],
                "selectedOptions": [
                    {
                        "option_id": "96",
                        "option_value_id": "397",
                        "checked": true
                    },
                    {
                        "option_id": "9",
                        "option_value_id": "20",
                        "checked": true
                    },
                    {
                        "option_id": "11",
                        "option_value_id": "31",
                        "checked": true
                    },
                    {
                        "option_id": "79",
                        "option_value_id": "330",
                        "checked": true
                    },
                    {
                        "option_id": "10",
                        "option_value_id": "26",
                        "checked": true
                    },
                    {
                        "option_id": "82",
                        "option_value_id": "422",
                        "checked": true
                    }
                ],
                "quantity": 3,
                "rotate": 0,
                "size": {
                    "width": 102,
                    "height": 152
                },
                "src": {
                    "thumbnail": "https://pechat.photo/image/cache/customer/authorized/cfecdb276f634854f3ef915e2e980c31/5ebbd7cc65a5ff9af6734344adfbded8-280x175-width.jpg",
                    "full": "https://pechat.photo/image/customer/authorized/cfecdb276f634854f3ef915e2e980c31/5ebbd7cc65a5ff9af6734344adfbded8.jpg"
                },
                "zoom": 8.512983241233734,
                "autoColorEnhance": false,
                "autoDetectBestFrame": false,
                "resolution": "2560x1600",
                "params": {
                    "album_photo_id": "60774",
                    "album_id": "2849",
                    "is_polaroid": "0",
                    "customer_id": "190",
                    "session_id": "",
                    "image": "customer/authorized/cfecdb276f634854f3ef915e2e980c31/5ebbd7cc65a5ff9af6734344adfbded8.jpg",
                    "hash": "5d23e75c22cc49852cfbc12a1cccf3f5",
                    "sort_order": "0",
                    "thumbnail": "https://pechat.photo/image/cache/customer/authorized/cfecdb276f634854f3ef915e2e980c31/5ebbd7cc65a5ff9af6734344adfbded8-280x175-width.jpg",
                    "resolution": "2560x1600",
                    "order_id": "3adf80f62a52d0000001"
                },
                "url": "https://pechat.photo/image/order/1651-f70770583e4e/1651-71111111111/10x15-glossy/3//laba_10x15_glossy_crop_200grm_5ebbd7cc65a5ff9af6734344adfbded8.jpg",
                "dest": {
                    "1": "image/order/render/1651-9370459b6044/1651-71111111111/10x15-glossy/3/"
                }
            }])
        });

        //photobox.updateImageUploadProgress(c, 50);
        let c = 0;
       /* let interval = setInterval(() => {
            photobox.addImages([
                {
                    "src": {
                        "thumbnail": `./img/1-thumbnail.jpg`,
                        "full": `./img/1-thumbnail.jpg`,
                        // "adjusted": `./img/1654596030680.jpg`
                    },

                }
            ]);
            c++;
            photobox.updateImageUploadProgress(c, 50);
            if(c > 10){
                clearInterval(interval);
            }
        }, 10)*/
        setTimeout(() => {
            for(let i = 1; i <= 0; i++){
                for(let j = 0; j <= 500; j++){
                   setTimeout(() => {
                       photobox.addImages([
                           {
                               "src": {
                                   "thumbnail": `./img/${i}-thumbnail.jpg`,
                                  // "adjusted": `./img/1654596030680.jpg`
                               },
                               "resolution": "5120x2880",
                               "frame": {
                                   "color": "#ffffff",
                                   "type": "none",
                                   "thickness": 5
                               },
                               "size": {
                                   "width": 9,
                                   "height": 9
                               },

                               "quantity": 1,
                               "zoom": 0
                           }
                       ])
                   }, 10)
                }
            }
        }, 5);

        photobox.onInit = function () {
            console.log('onInitGlob');

        }

        photobox.onDeleteAllPhotos(function () {
            console.log('onDeleteAllPhotos');
            localStorage.removeItem("images");
        });

        /*let progress = 1;
        setInterval(() => {
            photobox.updateImageUploadProgress(++progress, 60);
        }, 500)*/

        photobox.onMakeOrder((data) => {
            console.log(data.photos.slice(0, 1));
            //  console.log(data.photos[0].cropData);
        });
        photobox.onOpenUploadWindow(() => {
            alert("open window");
        })
        photobox.onPropertiesChanged((data) => {
            console.log('onPropertiesChanged');
            console.log(data);
        });
    }, 1000);
</script>

</body>
</html>
